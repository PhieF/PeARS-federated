<!--
SPDX-FileCopyrightText: 2024 PeARS Project, <community@pearsproject.org>, 

SPDX-License-Identifier: AGPL-3.0-only
-->

{% extends "base/base.html" %}
{% from "base/_formhelpers.html" import render_field %}
{% from "base/_formhelpers.html" import render_autocomplete_field %}
{% block body %}
<div class="container">
  <div class="row">
    <div class="col">
      <div class="alert alert-success text-center">
	      <b>{{num_entries}} {{gettext("pages recorded")}}</b>
      </div>
    </div>
  </div>

  <div class="row p-3">
    <div class="card-group">
      <div class="card indexer">
        <div class="card-header text-center"><b>{{gettext("Index a local file")}}</b></div>
        <div class="card-body">
        {% with messages = get_flashed_messages(category_filter=["url"]) %}
        {% if messages %}
            <div class="notification is-danger">
            {{ messages[0] }}</a>
            </div>
        {% endif %}
        {% endwith %}
	<form method="POST" accept-charset="UTF-8" action="{{url_for('indexer.index_from_local')}}" enctype="multipart/form-data">
	<datalist id="themes"></datalist>
        {{ form.hidden_tag() }}
        <p>{{ render_field(form.infile) }}</p>
        <p>{{ render_autocomplete_field(form.theme) }}</p>
        <p>{{ render_field(form.description) }}</p>
      </div><!-- card body -->
      <div class="card-footer clearfix">
        <span class="input-group-btn">
                <input id="submit_button" type="submit" class="btn btn-success" value="{{gettext('Add')}}">
      </div><!-- card footer -->
    </form>
    </div>
   </div>
  </div>
  </div>


<script>
  let themes = {{themes|tojson}};
  let str = '';
  for (theme of themes) {
    str += '<option value="' + theme + '" />';
  }
  document.getElementById("themes").innerHTML = str;
</script>

{% endblock %}
